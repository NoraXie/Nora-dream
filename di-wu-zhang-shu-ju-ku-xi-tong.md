
# 数据库的开始

## 文件系统的抽象

* 表示层
  * 文件
* 逻辑层
  * 文件系统\(相当于数据库管理系统的存储引擎\)
* 物理层
  * 元数据 
  * 数据块

## 文件管理的缺点

* 数据冗余和不一致性
* 数据访问困难
* 数据孤立
* 完整性问题
* 原子性问题
* 并发访问异常
* 安全性问题

## DBMS

数据库管理系统\(DBMS\)应运而生.从最开始流行的DBMS到21世纪的非结构化数据库主要有三种结构的DBMS.

* 层次模型
* 网状模型
* 关系模型\(结构化数据模型\)

> 关系模型

* 实体-关系模型
* 对象关系模型：基于对象的数据模型
* 半结构化数据模型：XML\(扩展标记语言\)

> 关系代数运算

交集 并集 差集 全集 补集

* 投影：只输出指定属性
* 选择：只输出符合条件的行
* 自然连接：具有相同名字的属性上所有取值相同的行
* 笛卡尔积：\(a+b\)\*\(c+d\)=ac+ad+bc+bd
* 并：集合运算

## DBMS体系结构

* 查询处理器
  * DML编译器
  * 嵌入式DML预编译器
  * DDL解释器
  * 查询求值引擎
* 存储器管理器
  * 文件管理器
  * 缓冲管理器
* 数据结构 \(方便物理实现\)
  * 权限及完整性管理器
  * 事务管理器
  * 数据字典 
  * 索引统计数据

## RDBMS

使用关系模型的数据库管理系统叫关系型数据库管理系统,即RDBMS.其中具有代表性的RDBMS有Oracle, MySQL, SQL SERVER.

# MySQL数据库架构 

## 数据库对象抽象 

* 表示层
  * 库 表 存储过程 视图 索引等等
* 逻辑层
  * 存储引擎
* 物理层
  * 数据库文件

## MySQL中的模块

> 连接管理器

接受请求 创建线程 认证用户 建立安全连接

> 表管理器

负责创建、读取或修改表定义文件；维护表描述符高速缓存；管理表锁；

> 表修改模块

表创建、删除、重命名、移除、更新或插入之类的操作；

> 表维护模块

检查、修改、备份、恢复、优化\(碎片整理\)及解析；

> 文件中记录组织

堆文件组织: 一条记录可以放在文件中的任何地方;

顺序文件组织: 根据"搜索码"值顺序存放;

散列文件组织:

> 访问路径的选择性

一个访问路径的选择性是所有获取的页面数（如果使用这个访问路径去获取所有想要的元组）。如果一个表包含一个与给定条件相匹配的索引，就至少存在两条访问路径：使用索引和扫描整个数据文件。

最有选择性的路径是检索最少页数的路径；使用最有选择性的路径将使用获取数据的代价降到最小。而一个访问路径的选择性依赖于选择条件中的主合取体（与涉及的索引有关），每个合取体就好比表上的一个过滤器，满足一个给定合取的元组在表中所占的百分比称为缩减因子。

\# MySQL工具

\#\# MySQL客户端工具

\* mysql

\* mysqldump

\* mysqladmin

\* mysqlcheck

\* mysqlimport

\#\# MySQL非客户端工具

\* myisamchk

\* myisampack

\#\# MySQL插件式存储引擎

&gt; MyISAM:

\* 每表三个文件：

\* .frm: 表结构

\* .MYD：表数据

\* .MYI：表索引

&gt; InnoDB：

\* 所有表共享一个表空间文件；

\* 建议：每表一个独立的表空间文件；

```
\* .frm: 表结构

\* .ibd: 表空间（表数据和表索引）
```

\#\# MySQL变量

&gt; MySQL服务器变量

作用域，分为两类：

\* 全局变量

\`\`\`sql

SHOW GLOBAL VARIABLES

\`\`\`

\* 会话变量

\`\`\`SQL

SHOW \[SESSION\] VARIABLES

\`\`\`

&gt; 生效时间，分为两类：

\* 动态：可即时修改

\* 静态：写在配置文件中,通过参数传递给mysqld

&gt; 动态调整参数的生效方式：

\* 全局：对当前会话无效，只对新建立会话有效；

\* 会话：即时生效，但只对当前会话有效；

&gt; 服务器变量：@@变量名

\* 显示：SELECT

\* 设定：SET GLOBAL\|SESSION 变量名='value'

\#\# MySQL常用命令

\`\`\`sql

SHOW CHARACTER SET;

SHOW COLLATION;

SELECT LAST\_INSERT\_ID\(\);

SHOW MASTER STATUS;

SHOW BINARY LOGS;

SHOW BINLOG EVENTS IN "file";

\`\`\`


数据库的开始
文件系统的抽象
表示层$$$$
文件
逻辑层
文件系统(相当于数据库管理系统的存储引擎)
物理层
元数据
数据块
文件管理的缺点
数据冗余和不一致性
数据访问困难
数据孤立
完整性问题
原子性问题
并发访问异常
安全性问题
DBMS
数据库管理系统(DBMS)应运而生.从最开始流行的DBMS到21世纪的非结构化数据库主要有三种结构的DBMS.
层次模型
网状模型
关系模型(结构化数据模型)
关系模型
实体-关系模型
对象关系模型：基于对象的数据模型
半结构化数据模型：XML(扩展标记语言)
关系代数运算
交集 并集 差集 全集 补集
投影：只输出指定属性
选择：只输出符合条件的行
自然连接：具有相同名字的属性上所有取值相同的行
笛卡尔积：(a+b)*(c+d)=ac+ad+bc+bd
并：集合运算
DBMS体系结构
查询处理器
DML编译器
嵌入式DML预编译器
DDL解释器
查询求值引擎
存储器管理器
文件管理器
缓冲管理器
数据结构 (方便物理实现)
权限及完整性管理器
事务管理器
数据字典
索引统计数据
RDBMS
使用关系模型的数据库管理系统叫关系型数据库管理系统,即RDBMS.其中具有代表性的RDBMS有Oracle, MySQL, SQL SERVER.
MySQL数据库架构
数据库对象抽象
表示层
库 表 存储过程 视图 索引等等
逻辑层
存储引擎
物理层
数据库文件
MySQL中的模块
连接管理器
接受请求 创建线程 认证用户 建立安全连接
表管理器
负责创建、读取或修改表定义文件；维护表描述符高速缓存；管理表锁；
表修改模块
表创建、删除、重命名、移除、更新或插入之类的操作；
表维护模块
检查、修改、备份、恢复、优化(碎片整理)及解析；
文件中记录组织
堆文件组织: 一条记录可以放在文件中的任何地方;
顺序文件组织: 根据"搜索码"值顺序存放;
散列文件组织:
访问路径的选择性
一个访问路径的选择性是所有获取的页面数（如果使用这个访问路径去获取所有想要的元组）。如果一个表包含一个与给定条件相匹配的索引，就至少存在两条访问路径：使用索引和扫描整个数据文件。
最有选择性的路径是检索最少页数的路径；使用最有选择性的路径将使用获取数据的代价降到最小。而一个访问路径的选择性依赖于选择条件中的主合取体（与涉及的索引有关），每个合取体就好比表上的一个过滤器，满足一个给定合取的元组在表中所占的百分比称为缩减因子。
# MySQL工具
## MySQL客户端工具
* mysql
* mysqldump
* mysqladmin
* mysqlcheck
* mysqlimport
## MySQL非客户端工具
* myisamchk
* myisampack
## MySQL插件式存储引擎
> MyISAM:
* 每表三个文件：
* .frm: 表结构
* .MYD：表数据
* .MYI：表索引
> InnoDB：
* 所有表共享一个表空间文件；
* 建议：每表一个独立的表空间文件；
\* .frm: 表结构

\* .ibd: 表空间（表数据和表索引）
## MySQL变量
> MySQL服务器变量
作用域，分为两类：
* 全局变量
```sql
SHOW GLOBAL VARIABLES
```
* 会话变量
```SQL
SHOW [SESSION] VARIABLES
```
> 生效时间，分为两类：
* 动态：可即时修改
* 静态：写在配置文件中,通过参数传递给mysqld
> 动态调整参数的生效方式：
* 全局：对当前会话无效，只对新建立会话有效；
* 会话：即时生效，但只对当前会话有效；
> 服务器变量：@@变量名
* 显示：SELECT
* 设定：SET GLOBAL|SESSION 变量名='value'
## MySQL常用命令
```sql
SHOW CHARACTER SET;
SHOW COLLATION;
SELECT LAST_INSERT_ID();
SHOW MASTER STATUS;
SHOW BINARY LOGS;
SHOW BINLOG EVENTS IN "file";
```